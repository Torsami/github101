{"version":3,"sources":["../src/user.js"],"names":["app","use","bodyParser","json","urlencoded","extended","text","type","secret","connectionString","pool","pg","Pool","user","host","database","password","port","verifyToken","req","res","next","token","cookies","decoded","jwt","verify","userData","error","cookie","status","send","success","message"],"mappings":";;;;;;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;;;AAEA,IAAMA,MAAM,wBAAZ;;AAEAA,IAAIC,GAAJ,CAAQC,qBAAWC,IAAX,EAAR;AACAH,IAAIC,GAAJ,CAAQC,qBAAWE,UAAX,CAAsB,EAAEC,UAAU,KAAZ,EAAtB,CAAR;AACAL,IAAIC,GAAJ,CAAQC,qBAAWI,IAAX,EAAR;AACAN,IAAIC,GAAJ,CAAQC,qBAAWC,IAAX,CAAgB,EAAEI,MAAM,kBAAR,EAAhB,CAAR;;AAEA,IAAMC,SAAS,QAAf;AACA,IAAMC,mBAAmB,0JAAzB;;AAEA,IAAMC,OAAO,IAAIC,aAAGC,IAAP,CAAY;;AAErBC,UAAM,cAFe;AAGrBC,UAAM,WAHe;AAIrBC,cAAU,YAJW;AAKrBC,cAAU,cALW;AAMrBC,UAAM;;AAGV;;AATyB,CAAZ,CAAb;;AAcA,IAAMC,cAAc,SAAdA,WAAc,CAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;;AAEpC;AACA,QAAMC,QAAQH,IAAII,OAAJ,CAAYD,KAA1B;;AAEA,QAAG;AACC,YAAME,UAAUC,uBAAIC,MAAJ,CAAWJ,KAAX,EAAkBd,MAAlB,CAAhB;AACAW,YAAIQ,QAAJ,GAAeH,OAAf;AACAH;AACH,KAJD,CAIC,OAAMO,KAAN,EAAY;AACTR,YAAIS,MAAJ,CAAW,UAAX,EAAuB,IAAvB;AACAT,YAAIS,MAAJ,CAAW,OAAX,EAAoB,IAApB;;AAEAT,YAAIU,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACjBC,4BADiB;AAEjBC;AAFiB,SAArB;AAIH;AAEJ,CAnBD;;kBAqBe,EAACvB,UAAD,EAAOQ,wBAAP,EAAoBV,cAApB,E","file":"user.js","sourcesContent":["import pg from 'pg';\r\nimport express from 'express';\r\nimport bodyParser from 'body-parser';\r\nimport jwt from 'jsonwebtoken';\r\n\r\nconst app = express();\r\n\r\napp.use(bodyParser.json());\r\napp.use(bodyParser.urlencoded({ extended: false }));\r\napp.use(bodyParser.text());                                    \r\napp.use(bodyParser.json({ type: 'application/json'})); \r\n\r\nconst secret = 'secret';\r\nconst connectionString = 'postgres://fgxmlcmztjlnqa:78ed6f0c9e151eb1f3fbb6e8a7a50ba3d4a9bf471e6498ea527119a2169ea645@ec2-107-20-167-11.compute-1.amazonaws.com:5432/da9ssf8703fkcj';\r\n\r\nconst pool = new pg.Pool({\r\n\r\n    user: 'samipostgres',\r\n    host: '127.0.0.1',\r\n    database: 'mydatabase',\r\n    password: 'samipostgres',\r\n    port: '5432'\r\n\r\n\r\n//connectionString: 'postgres://fgxmlcmztjlnqa:78ed6f0c9e151eb1f3fbb6e8a7a50ba3d4a9bf471e6498ea527119a2169ea645@ec2-107-20-167-11.compute-1.amazonaws.com:5432/da9ssf8703fkcj'\r\n\r\n});\r\n\r\n\r\nconst verifyToken = (req, res, next) => {\r\n\r\n    //const token = req.headers.authorization.split(\" \")[1];\r\n    const token = req.cookies.token;\r\n\r\n    try{\r\n        const decoded = jwt.verify(token, secret);\r\n        req.userData = decoded;\r\n        next();\r\n    }catch(error){\r\n        res.cookie(\"userData\", null);\r\n        res.cookie(\"token\", null);\r\n        \r\n        res.status(401).send({\r\n            success: `false`,\r\n            message: `Auth failed`\r\n        })\r\n    }\r\n\r\n}\r\n\r\nexport default {pool, verifyToken, secret};"]}